#!/bin/sh

preopen=
case "$1" in --preopen-cmd=*)
	preopen="${1#*=}"
	shift
esac

if [ -n "$preopen" ]; then
	$preopen "$@"
fi

if which emacsclient >/dev/null 2>&1; then
	e () {
		if emacsclient -n "$@" 2>/dev/null; then
			: ok
		elif [ -n "$DISPLAY" ]; then
			emacsclient -a '' -c -n "$@"
		else
			emacsclient -a '' "$@"
		fi
	}
else
	e () {
		emacs "$@"
	}
fi

e "$@"
